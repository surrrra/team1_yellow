---
title: "Analysis of Welfare for the Disabled"
author: "LJH"
format: html
editor: visual
---

## **장애유형별 정부 지원 만족도 분석**

![이전 수업 자료](%EC%9D%B4%EC%A0%84_%EC%9E%90%EB%A3%8C.png "장애등록 후 지원")

------------------------------------------------------------------------

SQL 수업에서 사용했었던 장애등록 후 지원에 대한 설문지 그래프로\
장애의 유형을 고려하지 않고 단순히 전체 응답 비율만 사용했었다.\
장애 유형에 따른 응답의 차이가 존재할까? \
있다면 그 이유는 무엇일까? 

------------------------------------------------------------------------

### 1. **데이터 정리**

```{r box1, echo=FALSE, fig.height= 10, fig.width=60}
data <- read.csv('장애인_지원_만족도.csv')
data
```

------------------------------------------------------------------------

설문조사는 장애 유형을 분류별로 구분해두고\
**매우 많음 / 약간 받고 있음 / 별로 받지 못하고 있음 / 전혀 받지 못하고 있음**\
으로 나뉘어 있으며 비율로 이미 계산되어있다.\
비중만으론 카이제곱검정이 불가능함으로 추가적인 데이터가 필요하다.

------------------------------------------------------------------------

```{r box2, echo=FALSE}
data_num <- read.csv('장애인_유형별_인구.csv')
data_num
```

------------------------------------------------------------------------

비율 문제를 해결하기 위해 위의 설문조사가 모집단을 대표한다는\
가정을 하고 같은 해의 **장애유형별 인구 수 데이터**를 추가한다.

------------------------------------------------------------------------

```{r box3, echo=FALSE}
data_all <- merge(data_num, data, by = '장애유형별')

data_all$매우.많음 <- round(data_all$매우.많음 * data_all$계 / 100, 0)
data_all$약간.받고.있음 <- round(data_all$약간.받고.있음 * data_all$계 / 100, 0)
data_all$별로.받지.못하고.있음 <- round(data_all$별로.받지.못하고.있음 * data_all$계 / 100, 0)
data_all$전혀.받지.못하고.있음 <- round(data_all$전혀.받지.못하고.있음 * data_all$계 / 100, 0)

data_all
```

------------------------------------------------------------------------

두 데이터를 합치고 각 행의 응답 비율을 인원 수와 곱하여\
응답 수로 구성된 새로운 데이터를 생성한다.

------------------------------------------------------------------------

\
![장애 유형별 분류](%EC%9E%A5%EC%95%A0%EC%9D%B8_%EB%B6%84%EB%A5%98.png "장애 유형별 분류")

------------------------------------------------------------------------

또한 소분류로만 구분되어 있던 장애 유형을 기준에 따른 대분류와 중분류로 추가해준다.

------------------------------------------------------------------------

```{r box4, echo=FALSE}
# 장애유형의 분류 설정
type.b.e <- c('지체장애', '뇌병변장애', '시각장애', '청각장애', '언어장애', '안면장애', '뇌전증(간질)장애')
type.b.i <- c('신장장애', '심장장애', '간장애', '호흡기장애','장루‧요루장애')
type.m.d <- c('지적장애', '자폐성장애')


# 장애유형의 중분류 설정
data_all$중분류 <- ifelse(data_all$장애유형별 %in% type.b.e, '신체외부.장애',
                   ifelse(data_all$장애유형별 %in% type.b.i, '신체내부.장애',
                          ifelse(data_all$장애유형별 %in% type.m.d, '발달.장애',
                                 ifelse(data_all$장애유형별 == '정신장애', '정신장애', '총'))))

# 장애유형의 대분류 설정
data_all$대분류 <- ifelse(data_all$장애유형별 %in% type.b.e | data_all$장애유형별 %in% type.b.i, '신체.장애',
                   ifelse(data_all$장애유형별 == '총', '총', '정신.장애'))
data_all <- data_all[c(8,7,1,2,3,4,5,6)]
data_all <- data_all[order(data_all$중분류),]
data_all <- data_all[order(data_all$대분류),]
rownames(data_all)=NULL
data_all  
```

## 2. 카이제곱 분석

#### 2.1 대분류와 만족도 간의 카이제곱 분석

```{r box5, echo=FALSE}
data.01 <- data_all[-16,]

'신체.장애' = c(sum(data.01[data.01$대분류 == '신체.장애',5]),
            sum(data.01[data.01$대분류 == '신체.장애',6]),
            sum(data.01[data.01$대분류 == '신체.장애',7]),
            sum(data.01[data.01$대분류 == '신체.장애',8]))

'정신.장애' =c(sum(data.01[data.01$대분류 != '신체.장애',5]),
           sum(data.01[data.01$대분류 != '신체.장애',6]),
           sum(data.01[data.01$대분류 != '신체.장애',7]),
           sum(data.01[data.01$대분류 != '신체.장애',8]))

data_by_big = matrix(c(신체.장애,정신.장애), ncol = 2)
dimnames(data_by_big) <-list("만족도" = c('매우.많음','약간.받고.있음','별로.받지.못하고.있음','전혀.받지.못하고.있음'),
                             "장애유형" = c('신체적.장애', '정신적.장애'))

data_by_big
```

```{r box6, echo=FALSE}
# 교차표의 행과 열의 합을 추가
addmargins(data_by_big)

# 열이 100% 척도 조정된 열의 비율 계산
addmargins(prop.table(addmargins(data_by_big, 2), 2), 1)
```

------------------------------------------------------------------------

\
대분류로 구분된 만족도의 합계와 그에 대한 비중을 구하고\
\
총 249566380개의 응답에서 신체적 장애와 관련된 응답은 212761426개이고, 정신적 장애와 관련된 응답은 36804954개이다.\
**신체적 장애** 응답 중 **부정적인 답변**('별로.받지.못하고.있음'과 '전혀.받지.못하고.있음')은 143184141(110382080 + 32802061)개로\
비율로는 약 **67%**이다.\
\
**정신적 장애** 응답 중 **부정적인 답변**은 15408374개이고 약 **42%**이다.\
반면에 '매우.많음'의 경우에는 신체적 장애가 약 3%, **정신적 장애**가 약 7%로\
**두 배 이상 긍정적인 답변**한 사실을 알 수 있다.\
\
**따라서 신체적 장애의 부정적인 응답의 비중이 정신적 장애의 부정적인 응답의 비중보다 높다.**\

------------------------------------------------------------------------

```{r box7, echo=FALSE}
# 이를 그래프로 시각화하면 다음과 같다
data_by_big.prop <- prop.table(data_by_big,2)
barplot(data_by_big.prop * 100, las =1,
        legend = T,
        col = c('cyan3', 'cyan', 'tomato', 'tomato3'),
        ylab = '만족도',
        main = '대분류에 따른 정부 보조 만족도')
```

------------------------------------------------------------------------

이를 그래프로 시각화하면 다음과 같다.

이 차이가 유의미한지 파악하기 위해 독립성검정을 해보자.

------------------------------------------------------------------------

```{r box9, echo=FALSE}
# chisq.text() 함수를 이용하여 독립성검정을 수행
chisq.test(data_by_big)
```

------------------------------------------------------------------------

**독립성검정**\
검정 결과p-값이 유의수준 0.05에 비해서 매우 작으므로\
**대분류에 따른 정부 보조 만족도과 관계가 없다**는 귀무가설을 **기각**할 수 있다.\
\

------------------------------------------------------------------------

#### 2.2 중분류와 만족도 간의 카이제곱 분석

```{r box10, echo=FALSE}
# 중분류 장애 유형과 만족도 간의 교차표 생성


'신체내부.장애' = c(sum(data.01[data.01$중분류 == '신체내부.장애',5]),
            sum(data.01[data.01$중분류 == '신체내부.장애',6]),
            sum(data.01[data.01$중분류 == '신체내부.장애',7]),
            sum(data.01[data.01$중분류 == '신체내부.장애',8]))

'신체외부.장애' = c(sum(data.01[data.01$중분류 == '신체외부.장애',5]),
              sum(data.01[data.01$중분류 == '신체외부.장애',6]),
              sum(data.01[data.01$중분류 == '신체외부.장애',7]),
              sum(data.01[data.01$중분류 == '신체외부.장애',8]))

'발달.장애' =c(sum(data.01[data.01$중분류 == '발달.장애',5]),
           sum(data.01[data.01$중분류 == '발달.장애',6]),
           sum(data.01[data.01$중분류 == '발달.장애',7]),
           sum(data.01[data.01$중분류 == '발달.장애',8]))

'정신장애' =c(sum(data.01[data.01$중분류 == '정신장애',5]),
           sum(data.01[data.01$중분류 == '정신장애',7]),
           sum(data.01[data.01$중분류 == '정신장애',8]),
           sum(data.01[data.01$중분류 == '정신장애',6]))


data_by_mid = matrix(c(신체내부.장애,신체외부.장애,발달.장애,정신장애), ncol = 4)
dimnames(data_by_mid) <-list("만족도" = c('매우.많음','약간.받고.있음','별로.받지.못하고.있음','전혀.받지.못하고.있음'),
                             "장애유형" = c('신체내부.장애', '신체외부.장애','발달.장애', '정신장애'))
data_by_mid
```

```{r box11, echo=FALSE}
# 교차표의 행과 열의 합을 추가
addmargins(data_by_mid)

# 열이 100% 척도 조정된 열의 비율 계산
addmargins(prop.table(addmargins(data_by_mid, 2), 2), 1)
```

```{r box11_1, echo=FALSE}
# 이를 그래프로 시각화하면 다음과 같다
data_by_mid.prop <- prop.table(data_by_mid,2)
barplot(data_by_mid.prop * 100, las =1,
        legend = T,
        col = c('cyan3', 'cyan', 'tomato', 'tomato3'),
        ylab = '만족도',
        main = '중분류에 따른 정부 보조 만족도')
```

chisq.text() 함수를 이용하여 독립성검정을 수행

```{r box13, echo=FALSE}
# 독립성검정
# chisq.text() 함수를 이용하여 독립성검정을 수행
chisq.test(data_by_mid)
```

------------------------------------------------------------------------

중분류의 경우 시각적으로 '신체외부.장애'가 다른 장애 분류와 비교해서\
부정적인 응답을 한 비중이 높다는 것을 알 수 있으며\
검정 결과 p-값이 유의수준 0.05에 비해서 매우 작으므로\
**중분류에 따른 정부 보조 만족도과 관계가 없다**는 귀무가설을 기각할 수 있다.\

------------------------------------------------------------------------

## 3. **요인분석**

**왜 이런 결과가 나올까?**

통계청에서 추가적인 데이터를 분석하여

```{r box14, echo=FALSE}
barplot(data_num[-1,]$계,
        names = data_num[-1,]$장애유형별,
        main = '신체 외부 장애 중 각 유형 별 수',
        col = c('tomato', 'grey', 'grey', 'grey', 'grey', 'grey', 'grey', 'grey', 'grey', 'grey', 'grey', 'grey', 'grey', 'grey', 'grey', 'grey')
        )
```

------------------------------------------------------------------------

신체 외부 장애의 경우, 지체 장애 유형이 대부분을 차지하며\

------------------------------------------------------------------------

```{r box15, echo=FALSE}
data.04 <-read.csv('장애인_추가_지출.csv')
data.04 <- data.04[-1, ]
barplot(data.04$추가.지출,
        main = '지체 장애인 장애로 인한 추가 지출',
        names = data.04$지출항목별.1.,
        cex.lab = 0.4,
        col = c('grey', 'tomato','grey', 'grey', 'grey', 'grey', 'grey', 'grey', 'grey'))
```

------------------------------------------------------------------------

지체 장애인들이 장애로 인한 추가적인 지출로 직접적인 의료비가 주요한 걸 알 수 있다.\

------------------------------------------------------------------------

```{r box16, echo=FALSE}
data.03 <-read.csv('장애인_복지_이용.csv')
barplot(data.03$빈도,
        main = '장애인 복지 사업',
        names = data.03$사업유형별,
        cex.lab = 0.4,
        col = c('grey','grey', 'grey', 'grey', 'grey',
                'cyan','cyan','cyan','cyan',
                'grey','grey', 'grey', 'grey', 'grey',
                'grey','grey', 'grey', 'grey', 'grey',
                'grey','grey', 'grey', 'grey', 'grey',
                'grey','grey'
                ))
```

------------------------------------------------------------------------

그러나 지체 장애인의 상황과 달리 정부 지원은 직접적인 의료 관련 복지가 미흡함을 알 수 있다.\

------------------------------------------------------------------------

------------------------------------------------------------------------

### **결론**

따라서 **'장애인은 장애 유형과 관계없이 복지에 대해 불만족이다.'**\
라는 일반적인 생각과는 달리\
신체적 장애, 그 중에서도 **지체장애**의 경우 유의미하게 더 **불만족**이 심하고\
이는 지체 장애인이 주로 원하는 지원이 **의료비 지원**인 반면\
실제 지원은 **미흡**하다는 사실 때문이라 생각할 수 있다.

------------------------------------------------------------------------

###### 자료출처

###### 통계청 : https://kostat.go.kr/portal/korea/index.action
