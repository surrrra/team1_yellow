<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="ss">

<title>project8</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="project8_files/libs/clipboard/clipboard.min.js"></script>
<script src="project8_files/libs/quarto-html/quarto.js"></script>
<script src="project8_files/libs/quarto-html/popper.min.js"></script>
<script src="project8_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="project8_files/libs/quarto-html/anchor.min.js"></script>
<link href="project8_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="project8_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="project8_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="project8_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="project8_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">project8</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>ss </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<ul>
<li>fixed.acidity(결합산) : 와인의 산도를 제어한다.<br>
</li>
<li>volatile.acidity(휘발산) : 와인의 향에 연관이 많다.</li>
<li>citric.acid(구연산) : 와인의 신선함을 유지시켜주는 역할을 하며, 산성화에 연관을 미친다.</li>
<li>residual.sugar(잔여 설탕) : 와인의 단맛을 올려준다.</li>
<li>chlorides(염소) : 와인의 짠맛과 신맛을 좌우하는 성분이다.</li>
<li>free.sulfur.dioxide / total.sulfur.dioxide / sulphates(황 화합물) : 특정 박테리아와 효모를 죽여 와인의 보관도를 높여준다.</li>
<li>density(밀도) : 바디의 높고 낮음을 표현하는 와인의 바디감을 의미한다.</li>
<li>pH(산성도) : 와인의 신맛의 정도를 나타낸다.</li>
<li>alcohol(알코올) : 와인에 단맛을 주며 바디감에 영향을 준다.</li>
<li>quality(퀄리티) : 결과적으로 다른 변수들을 이용하여 예측하려고 하는 변수로 와인의 퀄리티를 나타낸다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>wine <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'./winequality-white.csv'</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  fixed.acidity volatile.acidity citric.acid residual.sugar chlorides
1           7.0             0.27        0.36           20.7     0.045
2           6.3             0.30        0.34            1.6     0.049
3           8.1             0.28        0.40            6.9     0.050
4           7.2             0.23        0.32            8.5     0.058
5           7.2             0.23        0.32            8.5     0.058
6           8.1             0.28        0.40            6.9     0.050
  free.sulfur.dioxide total.sulfur.dioxide density   pH sulphates alcohol
1                  45                  170  1.0010 3.00      0.45     8.8
2                  14                  132  0.9940 3.30      0.49     9.5
3                  30                   97  0.9951 3.26      0.44    10.1
4                  47                  186  0.9956 3.19      0.40     9.9
5                  47                  186  0.9956 3.19      0.40     9.9
6                  30                   97  0.9951 3.26      0.44    10.1
  quality
1       6
2       6
3       6
4       6
5       6
6       6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   4898 obs. of  12 variables:
 $ fixed.acidity       : num  7 6.3 8.1 7.2 7.2 8.1 6.2 7 6.3 8.1 ...
 $ volatile.acidity    : num  0.27 0.3 0.28 0.23 0.23 0.28 0.32 0.27 0.3 0.22 ...
 $ citric.acid         : num  0.36 0.34 0.4 0.32 0.32 0.4 0.16 0.36 0.34 0.43 ...
 $ residual.sugar      : num  20.7 1.6 6.9 8.5 8.5 6.9 7 20.7 1.6 1.5 ...
 $ chlorides           : num  0.045 0.049 0.05 0.058 0.058 0.05 0.045 0.045 0.049 0.044 ...
 $ free.sulfur.dioxide : num  45 14 30 47 47 30 30 45 14 28 ...
 $ total.sulfur.dioxide: num  170 132 97 186 186 97 136 170 132 129 ...
 $ density             : num  1.001 0.994 0.995 0.996 0.996 ...
 $ pH                  : num  3 3.3 3.26 3.19 3.19 3.26 3.18 3 3.3 3.22 ...
 $ sulphates           : num  0.45 0.49 0.44 0.4 0.4 0.44 0.47 0.45 0.49 0.45 ...
 $ alcohol             : num  8.8 9.5 10.1 9.9 9.9 10.1 9.6 8.8 9.5 11 ...
 $ quality             : int  6 6 6 6 6 6 6 6 6 6 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(wine)) <span class="co"># NA값 확인</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fixed.acidity     volatile.acidity          citric.acid 
                   0                    0                    0 
      residual.sugar            chlorides  free.sulfur.dioxide 
                   0                    0                    0 
total.sulfur.dioxide              density                   pH 
                   0                    0                    0 
           sulphates              alcohol              quality 
                   0                    0                    0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wine<span class="sc">$</span>quality) <span class="co"># 연속형 변수 -&gt; 이산형화</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   3    4    5    6    7    8    9 
  20  163 1457 2198  880  175    5 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine<span class="sc">$</span>quality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  3.000   5.000   6.000   5.878   6.000   9.000 </code></pre>
</div>
</div>
<section id="quality-점수별-수치" class="level2">
<h2 class="anchored" data-anchor-id="quality-점수별-수치">Quality 점수별 수치</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wine,<span class="fu">aes</span>(quality)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">stat=</span><span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">"Quality of white wines"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Number of white wines"</span>) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"pink"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
</div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 평균 Quality 6점 thus, 7점부터 Good Wine</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rating 변수 추가 생성</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>wine<span class="sc">$</span>rating <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">as.integer</span>(wine<span class="sc">$</span>quality) <span class="sc">&gt;</span> <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wine<span class="sc">$</span>rating)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   0    1 
3838 1060 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> fixed.acidity    volatile.acidity  citric.acid     residual.sugar  
 Min.   : 3.800   Min.   :0.0800   Min.   :0.0000   Min.   : 0.600  
 1st Qu.: 6.300   1st Qu.:0.2100   1st Qu.:0.2700   1st Qu.: 1.700  
 Median : 6.800   Median :0.2600   Median :0.3200   Median : 5.200  
 Mean   : 6.855   Mean   :0.2782   Mean   :0.3342   Mean   : 6.391  
 3rd Qu.: 7.300   3rd Qu.:0.3200   3rd Qu.:0.3900   3rd Qu.: 9.900  
 Max.   :14.200   Max.   :1.1000   Max.   :1.6600   Max.   :65.800  
   chlorides       free.sulfur.dioxide total.sulfur.dioxide    density      
 Min.   :0.00900   Min.   :  2.00      Min.   :  9.0        Min.   :0.9871  
 1st Qu.:0.03600   1st Qu.: 23.00      1st Qu.:108.0        1st Qu.:0.9917  
 Median :0.04300   Median : 34.00      Median :134.0        Median :0.9937  
 Mean   :0.04577   Mean   : 35.31      Mean   :138.4        Mean   :0.9940  
 3rd Qu.:0.05000   3rd Qu.: 46.00      3rd Qu.:167.0        3rd Qu.:0.9961  
 Max.   :0.34600   Max.   :289.00      Max.   :440.0        Max.   :1.0390  
       pH          sulphates         alcohol         quality     
 Min.   :2.720   Min.   :0.2200   Min.   : 8.00   Min.   :3.000  
 1st Qu.:3.090   1st Qu.:0.4100   1st Qu.: 9.50   1st Qu.:5.000  
 Median :3.180   Median :0.4700   Median :10.40   Median :6.000  
 Mean   :3.188   Mean   :0.4898   Mean   :10.51   Mean   :5.878  
 3rd Qu.:3.280   3rd Qu.:0.5500   3rd Qu.:11.40   3rd Qu.:6.000  
 Max.   :3.820   Max.   :1.0800   Max.   :14.20   Max.   :9.000  
     rating      
 Min.   :0.0000  
 1st Qu.:0.0000  
 Median :0.0000  
 Mean   :0.2164  
 3rd Qu.:0.0000  
 Max.   :1.0000  </code></pre>
</div>
</div>
</section>
<section id="변수별-hist" class="level2">
<h2 class="anchored" data-anchor-id="변수별-hist">변수별 HIST</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> <span class="fu">names</span>(wine[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])){</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.numeric</span>(wine[,x])){</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">hist</span>(wine[,x],<span class="at">main =</span> x,<span class="at">xlab =</span> x,<span class="at">col=</span><span class="st">"pink"</span>, <span class="at">border=</span><span class="st">"white"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> <span class="fu">names</span>(wine[,<span class="dv">7</span><span class="sc">:</span><span class="dv">11</span>])){</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.numeric</span>(wine[,x])){</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">hist</span>(wine[,x],<span class="at">main =</span> x,<span class="at">xlab =</span> x,<span class="at">col=</span><span class="st">"pink"</span>, <span class="at">border=</span><span class="st">"white"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="변수들-간-산점도-행렬" class="level2">
<h2 class="anchored" data-anchor-id="변수들-간-산점도-행렬">변수들 간 산점도 행렬</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(wine[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>], <span class="at">col=</span><span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"skyblue"</span>), <span class="at">pch=</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="변수-간-상관행렬" class="level2">
<h2 class="anchored" data-anchor-id="변수-간-상관행렬">변수 간 상관행렬</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(wine[,<span class="sc">-</span><span class="dv">14</span>]), <span class="at">method =</span> <span class="st">"number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="다중회귀분석" class="level2">
<h2 class="anchored" data-anchor-id="다중회귀분석">다중회귀분석</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>wine <span class="ot">&lt;-</span> wine[,<span class="sc">-</span><span class="dv">15</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality<span class="sc">~</span>., <span class="at">data =</span> wine)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = quality ~ ., data = wine)

Residuals:
     Min       1Q   Median       3Q      Max 
-3.02957 -0.36583  0.04493  0.40301  2.01462 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           5.936e+01  1.315e+01   4.515 6.48e-06 ***
fixed.acidity        -1.167e-03  1.456e-02  -0.080 0.936113    
volatile.acidity     -1.418e+00  7.943e-02 -17.847  &lt; 2e-16 ***
citric.acid           7.284e-02  6.665e-02   1.093 0.274503    
residual.sugar        3.658e-02  5.275e-03   6.934 4.62e-12 ***
chlorides             1.379e-01  3.804e-01   0.363 0.716969    
free.sulfur.dioxide   1.651e-03  5.882e-04   2.808 0.005010 ** 
total.sulfur.dioxide  6.460e-05  2.631e-04   0.246 0.806079    
density              -5.588e+01  1.334e+01  -4.189 2.85e-05 ***
pH                    1.991e-01  7.365e-02   2.704 0.006877 ** 
sulphates             2.319e-01  7.008e-02   3.308 0.000945 ***
alcohol               1.024e-01  1.690e-02   6.059 1.47e-09 ***
rating                1.446e+00  2.004e-02  72.138  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5229 on 4885 degrees of freedom
Multiple R-squared:  0.6523,    Adjusted R-squared:  0.6514 
F-statistic: 763.7 on 12 and 4885 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 다중회귀분석 가정확인</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(model_1, <span class="at">direction =</span> <span class="st">'backward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-6338.79
quality ~ fixed.acidity + volatile.acidity + citric.acid + residual.sugar + 
    chlorides + free.sulfur.dioxide + total.sulfur.dioxide + 
    density + pH + sulphates + alcohol + rating

                       Df Sum of Sq    RSS     AIC
- fixed.acidity         1      0.00 1335.6 -6340.8
- total.sulfur.dioxide  1      0.02 1335.6 -6340.7
- chlorides             1      0.04 1335.6 -6340.7
- citric.acid           1      0.33 1335.9 -6339.6
&lt;none&gt;                              1335.6 -6338.8
- pH                    1      2.00 1337.6 -6333.5
- free.sulfur.dioxide   1      2.16 1337.7 -6332.9
- sulphates             1      2.99 1338.6 -6329.8
- density               1      4.80 1340.4 -6323.2
- alcohol               1     10.04 1345.6 -6304.1
- residual.sugar        1     13.15 1348.7 -6292.8
- volatile.acidity      1     87.09 1422.7 -6031.4
- rating                1   1422.76 2758.3 -2788.4

Step:  AIC=-6340.78
quality ~ volatile.acidity + citric.acid + residual.sugar + chlorides + 
    free.sulfur.dioxide + total.sulfur.dioxide + density + pH + 
    sulphates + alcohol + rating

                       Df Sum of Sq    RSS     AIC
- total.sulfur.dioxide  1      0.02 1335.6 -6342.7
- chlorides             1      0.04 1335.6 -6342.6
- citric.acid           1      0.33 1335.9 -6341.6
&lt;none&gt;                              1335.6 -6340.8
- free.sulfur.dioxide   1      2.16 1337.7 -6334.9
- sulphates             1      3.12 1338.7 -6331.4
- pH                    1      3.75 1339.3 -6329.0
- density               1      9.82 1345.4 -6306.9
- alcohol               1     15.35 1350.9 -6286.8
- residual.sugar        1     24.61 1360.2 -6253.4
- volatile.acidity      1     87.67 1423.2 -6031.4
- rating                1   1428.32 2763.9 -2780.6

Step:  AIC=-6342.72
quality ~ volatile.acidity + citric.acid + residual.sugar + chlorides + 
    free.sulfur.dioxide + density + pH + sulphates + alcohol + 
    rating

                      Df Sum of Sq    RSS     AIC
- chlorides            1      0.04 1335.6 -6344.6
- citric.acid          1      0.33 1335.9 -6343.5
&lt;none&gt;                             1335.6 -6342.7
- sulphates            1      3.18 1338.8 -6333.1
- free.sulfur.dioxide  1      3.69 1339.3 -6331.2
- pH                   1      3.76 1339.3 -6331.0
- density              1     10.20 1345.8 -6307.5
- alcohol              1     15.38 1351.0 -6288.6
- residual.sugar       1     24.93 1360.5 -6254.1
- volatile.acidity     1     90.81 1426.4 -6022.5
- rating               1   1428.74 2764.3 -2781.8

Step:  AIC=-6344.57
quality ~ volatile.acidity + citric.acid + residual.sugar + free.sulfur.dioxide + 
    density + pH + sulphates + alcohol + rating

                      Df Sum of Sq    RSS     AIC
- citric.acid          1      0.36 1336.0 -6345.3
&lt;none&gt;                             1335.6 -6344.6
- sulphates            1      3.17 1338.8 -6334.9
- pH                   1      3.72 1339.3 -6332.9
- free.sulfur.dioxide  1      3.74 1339.4 -6332.9
- density              1     10.16 1345.8 -6309.5
- alcohol              1     15.46 1351.1 -6290.2
- residual.sugar       1     25.03 1360.7 -6255.6
- volatile.acidity     1     91.67 1427.3 -6021.4
- rating               1   1429.28 2764.9 -2782.8

Step:  AIC=-6345.27
quality ~ volatile.acidity + residual.sugar + free.sulfur.dioxide + 
    density + pH + sulphates + alcohol + rating

                      Df Sum of Sq    RSS     AIC
&lt;none&gt;                             1336.0 -6345.3
- sulphates            1      3.22 1339.2 -6335.5
- pH                   1      3.39 1339.4 -6334.8
- free.sulfur.dioxide  1      3.94 1339.9 -6332.8
- density              1      9.83 1345.8 -6311.4
- alcohol              1     17.13 1353.1 -6284.9
- residual.sugar       1     24.81 1360.8 -6257.1
- volatile.acidity     1     96.61 1432.6 -6005.3
- rating               1   1429.07 2765.1 -2784.5</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = quality ~ volatile.acidity + residual.sugar + free.sulfur.dioxide + 
    density + pH + sulphates + alcohol + rating, data = wine)

Coefficients:
        (Intercept)     volatile.acidity       residual.sugar  
          56.885238            -1.424855             0.035722  
free.sulfur.dioxide              density                   pH  
           0.001789           -53.341570             0.187580  
          sulphates              alcohol               rating  
           0.235860             0.104073             1.445260  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">formula =</span> quality <span class="sc">~</span> volatile.acidity <span class="sc">+</span> residual.sugar <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    density <span class="sc">+</span> pH <span class="sc">+</span> sulphates <span class="sc">+</span> alcohol <span class="sc">+</span> rating, <span class="at">data =</span> wine))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = quality ~ volatile.acidity + residual.sugar + free.sulfur.dioxide + 
    density + pH + sulphates + alcohol + rating, data = wine)

Residuals:
     Min       1Q   Median       3Q      Max 
-3.04881 -0.36379  0.04407  0.40237  2.01590 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          5.689e+01  8.880e+00   6.406 1.63e-10 ***
volatile.acidity    -1.425e+00  7.578e-02 -18.802  &lt; 2e-16 ***
residual.sugar       3.572e-02  3.749e-03   9.528  &lt; 2e-16 ***
free.sulfur.dioxide  1.789e-03  4.711e-04   3.798 0.000147 ***
density             -5.334e+01  8.893e+00  -5.998 2.14e-09 ***
pH                   1.876e-01  5.324e-02   3.524 0.000430 ***
sulphates            2.359e-01  6.868e-02   3.434 0.000599 ***
alcohol              1.041e-01  1.315e-02   7.917 2.99e-15 ***
rating               1.445e+00  1.999e-02  72.316  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5227 on 4889 degrees of freedom
Multiple R-squared:  0.6522,    Adjusted R-squared:  0.6516 
F-statistic:  1146 on 8 and 4889 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="독립변수간-상관관계" class="level2">
<h2 class="anchored" data-anchor-id="독립변수간-상관관계">독립변수간 상관관계</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="sc">~</span>volatile.acidity <span class="sc">+</span> residual.sugar <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    density <span class="sc">+</span> pH <span class="sc">+</span> sulphates <span class="sc">+</span> alcohol <span class="sc">+</span> rating, <span class="at">data =</span> wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">lm</span>(<span class="at">formula =</span> quality <span class="sc">~</span> volatile.acidity <span class="sc">+</span> residual.sugar <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>     density <span class="sc">+</span> pH <span class="sc">+</span> sulphates <span class="sc">+</span> alcohol <span class="sc">+</span> rating, <span class="at">data =</span> wine))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   volatile.acidity      residual.sugar free.sulfur.dioxide             density 
           1.045526            6.479484            1.150249           12.678481 
                 pH           sulphates             alcohol              rating 
           1.157992            1.100837            4.689619            1.214036 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">lm</span>(<span class="at">formula =</span> quality <span class="sc">~</span> volatile.acidity <span class="sc">+</span> residual.sugar <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>     pH <span class="sc">+</span> sulphates <span class="sc">+</span> alcohol <span class="sc">+</span> rating, <span class="at">data =</span> wine))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   volatile.acidity      residual.sugar free.sulfur.dioxide                  pH 
           1.039751            1.383678            1.143373            1.072800 
          sulphates             alcohol              rating 
           1.032642            1.521961            1.204526 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> quality <span class="sc">~</span> volatile.acidity <span class="sc">+</span> residual.sugar <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>     pH <span class="sc">+</span> sulphates <span class="sc">+</span> alcohol <span class="sc">+</span> rating, <span class="at">data =</span> wine) </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">round</span>(<span class="fu">predict</span>(model_2, <span class="at">newdata =</span> wine[,<span class="sc">-</span><span class="dv">14</span>], <span class="at">type =</span> <span class="st">'response'</span>)) <span class="sc">==</span> wine<span class="sc">$</span>quality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6939567</code></pre>
</div>
</div>
</section>
<section id="로지스틱-회귀분석" class="level2">
<h2 class="anchored" data-anchor-id="로지스틱-회귀분석">로지스틱 회귀분석</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(rating <span class="sc">~</span> .<span class="sc">-</span>quality, <span class="at">data =</span> wine, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">'logit'</span>))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = rating ~ . - quality, family = binomial(link = "logit"), 
    data = wine)

Coefficients:
         (Intercept)         fixed.acidity      volatile.acidity  
           6.362e+02             5.521e-01            -3.785e+00  
         citric.acid        residual.sugar             chlorides  
          -7.378e-01             2.952e-01            -1.264e+01  
 free.sulfur.dioxide  total.sulfur.dioxide               density  
           8.645e-03            -2.696e-04            -6.591e+02  
                  pH             sulphates               alcohol  
           3.343e+00             2.168e+00             1.423e-01  

Degrees of Freedom: 4897 Total (i.e. Null);  4886 Residual
Null Deviance:      5117 
Residual Deviance: 4143     AIC: 4167</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = rating ~ . - quality, family = binomial(link = "logit"), 
    data = wine)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1436  -0.6725  -0.4114  -0.1798   2.8331  

Coefficients:
                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           6.362e+02  9.412e+01   6.759 1.39e-11 ***
fixed.acidity         5.521e-01  9.053e-02   6.099 1.07e-09 ***
volatile.acidity     -3.785e+00  4.885e-01  -7.749 9.28e-15 ***
citric.acid          -7.378e-01  4.010e-01  -1.840 0.065776 .  
residual.sugar        2.952e-01  3.564e-02   8.283  &lt; 2e-16 ***
chlorides            -1.264e+01  3.816e+00  -3.312 0.000926 ***
free.sulfur.dioxide   8.645e-03  3.130e-03   2.762 0.005749 ** 
total.sulfur.dioxide -2.696e-04  1.506e-03  -0.179 0.857936    
density              -6.591e+02  9.540e+01  -6.909 4.89e-12 ***
pH                    3.343e+00  4.268e-01   7.832 4.81e-15 ***
sulphates             2.168e+00  3.475e-01   6.238 4.42e-10 ***
alcohol               1.423e-01  1.139e-01   1.250 0.211334    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5116.8  on 4897  degrees of freedom
Residual deviance: 4143.2  on 4886  degrees of freedom
AIC: 4167.2

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(model, <span class="at">direction =</span> <span class="st">'backward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4167.22
rating ~ (fixed.acidity + volatile.acidity + citric.acid + residual.sugar + 
    chlorides + free.sulfur.dioxide + total.sulfur.dioxide + 
    density + pH + sulphates + alcohol + quality) - quality

                       Df Deviance    AIC
- total.sulfur.dioxide  1   4143.3 4165.3
- alcohol               1   4144.8 4166.8
&lt;none&gt;                      4143.2 4167.2
- citric.acid           1   4146.7 4168.7
- free.sulfur.dioxide   1   4150.9 4172.9
- chlorides             1   4155.9 4177.9
- sulphates             1   4182.3 4204.3
- fixed.acidity         1   4182.5 4204.5
- density               1   4196.5 4218.5
- pH                    1   4207.8 4229.8
- volatile.acidity      1   4208.8 4230.8
- residual.sugar        1   4219.9 4241.9

Step:  AIC=4165.26
rating ~ fixed.acidity + volatile.acidity + citric.acid + residual.sugar + 
    chlorides + free.sulfur.dioxide + density + pH + sulphates + 
    alcohol

                      Df Deviance    AIC
- alcohol              1   4144.8 4164.8
&lt;none&gt;                     4143.3 4165.3
- citric.acid          1   4146.8 4166.8
- free.sulfur.dioxide  1   4154.5 4174.5
- chlorides            1   4156.0 4176.0
- sulphates            1   4182.5 4202.5
- fixed.acidity        1   4183.6 4203.6
- density              1   4201.7 4221.7
- pH                   1   4208.6 4228.6
- volatile.acidity     1   4212.4 4232.4
- residual.sugar       1   4224.3 4244.3

Step:  AIC=4164.78
rating ~ fixed.acidity + volatile.acidity + citric.acid + residual.sugar + 
    chlorides + free.sulfur.dioxide + density + pH + sulphates

                      Df Deviance    AIC
&lt;none&gt;                     4144.8 4164.8
- citric.acid          1   4147.9 4165.9
- free.sulfur.dioxide  1   4155.7 4173.7
- chlorides            1   4157.0 4175.0
- sulphates            1   4193.8 4211.8
- volatile.acidity     1   4212.6 4230.6
- fixed.acidity        1   4240.9 4258.9
- pH                   1   4273.3 4291.3
- residual.sugar       1   4477.1 4495.1
- density              1   4687.0 4705.0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = rating ~ fixed.acidity + volatile.acidity + citric.acid + 
    residual.sugar + chlorides + free.sulfur.dioxide + density + 
    pH + sulphates, family = binomial(link = "logit"), data = wine)

Coefficients:
        (Intercept)        fixed.acidity     volatile.acidity  
          7.443e+02            6.302e-01           -3.687e+00  
        citric.acid       residual.sugar            chlorides  
         -6.927e-01            3.324e-01           -1.238e+01  
free.sulfur.dioxide              density                   pH  
          8.177e-03           -7.684e+02            3.682e+00  
          sulphates  
          2.307e+00  

Degrees of Freedom: 4897 Total (i.e. Null);  4888 Residual
Null Deviance:      5117 
Residual Deviance: 4145     AIC: 4165</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>glm_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> rating <span class="sc">~</span> fixed.acidity <span class="sc">+</span> volatile.acidity <span class="sc">+</span> citric.acid <span class="sc">+</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    residual.sugar <span class="sc">+</span> chlorides <span class="sc">+</span> free.sulfur.dioxide <span class="sc">+</span> density <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    pH <span class="sc">+</span> sulphates, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">data =</span> wine)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = rating ~ fixed.acidity + volatile.acidity + citric.acid + 
    residual.sugar + chlorides + free.sulfur.dioxide + density + 
    pH + sulphates, family = binomial(link = "logit"), data = wine)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3552  -0.6766  -0.4103  -0.1794   2.8148  

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          7.443e+02  3.464e+01  21.490  &lt; 2e-16 ***
fixed.acidity        6.302e-01  6.587e-02   9.567  &lt; 2e-16 ***
volatile.acidity    -3.687e+00  4.671e-01  -7.893 2.95e-15 ***
citric.acid         -6.927e-01  3.972e-01  -1.744 0.081151 .  
residual.sugar       3.324e-01  1.932e-02  17.205  &lt; 2e-16 ***
chlorides           -1.238e+01  3.800e+00  -3.259 0.001119 ** 
free.sulfur.dioxide  8.177e-03  2.470e-03   3.310 0.000932 ***
density             -7.684e+02  3.574e+01 -21.501  &lt; 2e-16 ***
pH                   3.682e+00  3.313e-01  11.115  &lt; 2e-16 ***
sulphates            2.307e+00  3.296e-01   6.999 2.58e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5116.8  on 4897  degrees of freedom
Residual deviance: 4144.8  on 4888  degrees of freedom
AIC: 4164.8

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>wine<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  glm_model<span class="sc">$</span>fitted.values <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(wine<span class="sc">$</span>pred, wine<span class="sc">$</span>rating)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     
         0    1
  No  3626  760
  Yes  212  300</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>TP <span class="ot">&lt;-</span> tab[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>TN <span class="ot">&lt;-</span> tab[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>FP <span class="ot">&lt;-</span> tab[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>FN <span class="ot">&lt;-</span> tab[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> (TP <span class="sc">+</span> TN) <span class="sc">/</span> <span class="fu">sum</span>(tab)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8015517</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc</span>(rating <span class="sc">~</span> glm_model<span class="sc">$</span>fitted.values, <span class="at">data =</span> wine, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">'ROC CURVE'</span>, <span class="at">auc =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
roc.formula(formula = rating ~ glm_model$fitted.values, data = wine,     plot = TRUE, main = "ROC CURVE", auc = T)

Data: glm_model$fitted.values in 3838 controls (rating 0) &lt; 1060 cases (rating 1).
Area under the curve: 0.7938</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(glm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        (Intercept)       fixed.acidity    volatile.acidity         citric.acid 
       7.443217e+02        6.301870e-01       -3.686958e+00       -6.927095e-01 
     residual.sugar           chlorides free.sulfur.dioxide             density 
       3.324403e-01       -1.238154e+01        8.176799e-03       -7.683960e+02 
                 pH           sulphates 
       3.682339e+00        2.306562e+00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(glm_model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        (Intercept)       fixed.acidity    volatile.acidity         citric.acid 
                Inf        1.877962e+00        2.504807e-02        5.002189e-01 
     residual.sugar           chlorides free.sulfur.dioxide             density 
       1.394367e+00        4.195329e-06        1.008210e+00        0.000000e+00 
                 pH           sulphates 
       3.973922e+01        1.003984e+01 </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>